🧩 一、子查詢（Subquery）

子查詢就是「查詢中的查詢」，它出現在 SELECT、WHERE 或 FROM 子句裡，用來提供另一個查詢的結果。
最常見的用途：

找出「相對於另一個資料表」的資料。

📘 範例
SELECT name, salary
FROM employees
WHERE salary > (
  SELECT AVG(salary)
  FROM employees
);


👉 說明：
這裡的括號內是子查詢，它先算出平均薪水，再由外層查出「薪水高於平均」的員工。

🔹 二、ANY（或 SOME）

ANY 表示：只要子查詢的結果中，有任意一個值滿足條件，就成立。

📘 範例
SELECT name, salary
FROM employees
WHERE salary > ANY (
  SELECT salary
  FROM employees
  WHERE department_id = 10
);


👉 說明：

子查詢會先找出部門 10 所有員工的薪水。

外層查詢會找出「薪水比部門 10 的 任何一個人高」的員工。
（實際上只要比部門 10 中最小的薪水高，就會被選中。）

🧠 小技巧：

> ANY ≈ > MIN(...)

< ANY ≈ < MAX(...)

🔸 三、ALL

ALL 表示：必須滿足子查詢中「所有值」的條件才成立。

📘 範例
SELECT name, salary
FROM employees
WHERE salary > ALL (
  SELECT salary
  FROM employees
  WHERE department_id = 10
);


👉 說明：

子查詢會先列出部門 10 的所有薪水。

外層查出「薪水比部門 10 所有員工都高」的員工。

🧠 小技巧：

> ALL ≈ > MAX(...)

< ALL ≈ < MIN(...)

🔹 四、EXISTS

EXISTS 表示：子查詢有返回至少一筆資料，就為真 (TRUE)。
它通常搭配相關子查詢（correlated subquery）使用。

📘 範例
SELECT name
FROM employees e
WHERE EXISTS (
  SELECT 1
  FROM departments d
  WHERE d.manager_id = e.employee_id
);


👉 說明：

子查詢會檢查該員工是否是某個部門的主管。

若存在至少一筆符合的紀錄，EXISTS 為 TRUE，該員工就會被選出。

🧠 小技巧：

EXISTS 只關心「有沒有結果」，不管子查詢 SELECT 什麼。

常用來測試「關聯是否存在」。

📊 總結比較表
關鍵字	意義	用法重點	範例說明
Subquery	查詢中的查詢	可放在 SELECT、WHERE、FROM 中	找出薪水高於平均者
ANY / SOME	任意一個符合即成立	通常搭配 =, >, <	薪水高於某部門任意員工
ALL	必須全部符合	通常搭配 =, >, <	薪水高於某部門所有員工
EXISTS	檢查子查詢是否有結果	通常搭配關聯子查詢	判斷是否是主管